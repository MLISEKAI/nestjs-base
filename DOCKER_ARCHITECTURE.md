# ğŸ—ï¸ Docker Architecture & UML Diagrams

## ğŸ“Š Container Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Docker Host Machine                          â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            Docker Network: nestjs-network (Bridge)        â”‚  â”‚
â”‚  â”‚                         172.18.0.0/16                     â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚  â”‚
â”‚  â”‚  â”‚   PostgreSQL     â”‚  â”‚      Redis       â”‚             â”‚  â”‚
â”‚  â”‚  â”‚   Container      â”‚  â”‚   Container      â”‚             â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚  â”‚
â”‚  â”‚  â”‚ postgres:16      â”‚  â”‚ redis:7-alpine   â”‚             â”‚  â”‚
â”‚  â”‚  â”‚ Port: 5432       â”‚  â”‚ Port: 6379       â”‚             â”‚  â”‚
â”‚  â”‚  â”‚ User: postgres   â”‚  â”‚ Auth: password   â”‚             â”‚  â”‚
â”‚  â”‚  â”‚ DB: nestjs_db    â”‚  â”‚ Cache: memory    â”‚             â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  â”‚
â”‚  â”‚           â”‚                     â”‚                        â”‚  â”‚
â”‚  â”‚           â”‚                     â”‚                        â”‚  â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚  â”‚
â”‚  â”‚                      â”‚                                   â”‚  â”‚
â”‚  â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚  â”‚
â”‚  â”‚            â”‚   NestJS App      â”‚                         â”‚  â”‚
â”‚  â”‚            â”‚   Container       â”‚                         â”‚  â”‚
â”‚  â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚  â”‚
â”‚  â”‚            â”‚ node:20-alpine    â”‚                         â”‚  â”‚
â”‚  â”‚            â”‚ Port: 3001        â”‚â—„â”€â”€â”€â”€â”€â”€ HTTP :3001       â”‚  â”‚
â”‚  â”‚            â”‚ User: nestjs      â”‚                         â”‚  â”‚
â”‚  â”‚            â”‚ Auto Migration    â”‚                         â”‚  â”‚
â”‚  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   Docker Volumes                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â”‚
â”‚  â”‚  â”‚ postgres_data    â”‚  â”‚   redis_data     â”‚              â”‚  â”‚
â”‚  â”‚  â”‚ (Persistent DB)  â”‚  â”‚ (Persistent Cache)â”‚             â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Container Lifecycle & Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Container Startup Flow                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. docker-compose up -d
         â”‚
         â”œâ”€â–º Start PostgreSQL Container
         â”‚   â”œâ”€â–º Load postgres_data volume
         â”‚   â”œâ”€â–º Health check: pg_isready
         â”‚   â””â”€â–º Status: Healthy âœ“
         â”‚
         â”œâ”€â–º Start Redis Container
         â”‚   â”œâ”€â–º Load redis_data volume
         â”‚   â”œâ”€â–º Health check: redis-cli ping
         â”‚   â””â”€â–º Status: Healthy âœ“
         â”‚
         â””â”€â–º Start NestJS App Container
             â”œâ”€â–º Wait for PostgreSQL (healthy)
             â”œâ”€â–º Wait for Redis (healthy)
             â”œâ”€â–º Run docker-entrypoint.sh
             â”‚   â”œâ”€â–º Check PostgreSQL connection
             â”‚   â”œâ”€â–º Run Prisma migrations
             â”‚   â”œâ”€â–º Generate Prisma Client
             â”‚   â””â”€â–º Start node dist/src/main.js
             â”‚
             â””â”€â–º Status: Running & Healthy âœ“

```

## ğŸŒ Network Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         HTTP :3001          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   NestJS App  â”‚
â”‚  (Browser) â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   Container   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      JSON Response          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                              â”‚              â”‚
                    â”‚                              â”‚              â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚   PostgreSQL        â”‚        â”‚     Redis         â”‚   â”‚
         â”‚   :5432             â”‚        â”‚     :6379         â”‚   â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
         â”‚ â€¢ Users data        â”‚        â”‚ â€¢ Session cache   â”‚   â”‚
         â”‚ â€¢ Posts data        â”‚        â”‚ â€¢ API cache       â”‚   â”‚
         â”‚ â€¢ Transactions      â”‚        â”‚ â€¢ Rate limiting   â”‚   â”‚
         â”‚ â€¢ Relationships     â”‚        â”‚ â€¢ Temp data       â”‚   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                                                                 â”‚
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚  Prisma ORM    â”‚
                                â”‚  (Connection   â”‚
                                â”‚   Pooling)     â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ Container Internals - NestJS App

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              NestJS App Container Structure                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  /app/                                                        â”‚
â”‚  â”œâ”€â”€ dist/                    (Compiled TypeScript)          â”‚
â”‚  â”‚   â””â”€â”€ src/                                                â”‚
â”‚  â”‚       â”œâ”€â”€ main.js          (Entry point)                  â”‚
â”‚  â”‚       â”œâ”€â”€ app.module.js                                   â”‚
â”‚  â”‚       â”œâ”€â”€ auth/                                           â”‚
â”‚  â”‚       â”œâ”€â”€ modules/                                        â”‚
â”‚  â”‚       â””â”€â”€ ...                                             â”‚
â”‚  â”‚                                                           â”‚
â”‚  â”œâ”€â”€ node_modules/            (Production dependencies)      â”‚
â”‚  â”‚   â””â”€â”€ .prisma/             (Generated Prisma Client)      â”‚
â”‚  â”‚                                                           â”‚
â”‚  â”œâ”€â”€ src/prisma/              (Database schema & migrations) â”‚
â”‚  â”‚   â”œâ”€â”€ schema.prisma                                       â”‚
â”‚  â”‚   â””â”€â”€ migrations/                                         â”‚
â”‚  â”‚                                                           â”‚
â”‚  â””â”€â”€ package.json             (Dependencies manifest)        â”‚
â”‚                                                               â”‚
â”‚  User: nestjs (UID: 1001)                                    â”‚
â”‚  Group: nodejs (GID: 1001)                                   â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Security Layers                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 1: Network Isolation
â”œâ”€â–º Private Docker network (bridge)
â”œâ”€â–º Only App port exposed to host
â””â”€â–º Database & Redis internal only

Layer 2: Container Security
â”œâ”€â–º Non-root user (nestjs:nodejs)
â”œâ”€â–º Alpine Linux (minimal attack surface)
â”œâ”€â–º Read-only where possible
â””â”€â–º Health checks enabled

Layer 3: Application Security
â”œâ”€â–º Helmet.js (HTTP headers)
â”œâ”€â–º CORS protection
â”œâ”€â–º Input validation (class-validator)
â”œâ”€â–º Input sanitization (XSS protection)
â””â”€â–º Rate limiting (Redis-backed)

Layer 4: Data Security
â”œâ”€â–º Password hashing (argon2)
â”œâ”€â–º JWT authentication
â”œâ”€â–º Environment variable secrets
â”œâ”€â–º PostgreSQL role-based access
â””â”€â–º Connection pooling

Layer 5: Monitoring & Logging
â”œâ”€â–º Health checks (Docker)
â”œâ”€â–º Winston logging
â”œâ”€â–º Performance monitoring
â””â”€â–º Error tracking
```

## ğŸ¯ Deployment Scenarios

### Scenario 1: Development (Local Machine)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Development Environment           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚  Your IDE  â”‚                          â”‚
â”‚  â”‚  (VSCode)  â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚        â”‚                                 â”‚
â”‚        â”‚ Hot reload                      â”‚
â”‚        â–¼                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      Docker              â”‚
â”‚  â”‚   npm run  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ start:dev  â”‚â”€â”€â”€â”¤PostgreSQLâ”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  Redis   â”‚          â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                          â”‚
â”‚  File: docker-compose.dev.yml           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Scenario 2: Production (Single Server)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Production Environment             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  Internet                                â”‚
â”‚     â”‚                                    â”‚
â”‚     â”œâ”€â”€â–º :80/:443 (Nginx/Traefik)       â”‚
â”‚     â”‚                                    â”‚
â”‚     â””â”€â”€â–º :3001                           â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚          â”‚  NestJS    â”‚                  â”‚
â”‚          â”‚    App     â”‚                  â”‚
â”‚          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                â”‚                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚     â”‚                     â”‚              â”‚
â”‚  â”Œâ”€â”€â–¼â”€â”€â”€â”            â”Œâ”€â”€â”€â–¼â”€â”€â”           â”‚
â”‚  â”‚ PG   â”‚            â”‚Redis â”‚           â”‚
â”‚  â”‚ SQL  â”‚            â”‚      â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                          â”‚
â”‚  File: docker-compose.yml               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Scenario 3: Production (Cloud - Multi Container)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Cloud Environment (AWS/GCP/Azure)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  Load Balancer                                       â”‚
â”‚       â”‚                                              â”‚
â”‚       â”œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚       â”‚      â”‚      â”‚      â”‚                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â–¼â” â”Œâ”€â”€â–¼â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ App1â”‚ â”‚ App2â”‚ â”‚ App3â”‚ â”‚ ... â”‚                   â”‚
â”‚  â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜                   â”‚
â”‚     â”‚       â”‚       â”‚       â”‚                       â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚              â”‚                                       â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚     â”‚                 â”‚                             â”‚
â”‚  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ RDS/Cloud SQL â”‚ â”‚ ElastiCache/ â”‚                â”‚
â”‚  â”‚  (PostgreSQL) â”‚ â”‚ Redis Cloud  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Health Check Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Health Check System             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Docker Engine
     â”‚
     â”œâ”€â–º Every 30s
     â”‚
     â”œâ”€â–º PostgreSQL Health Check
     â”‚   â””â”€â–º pg_isready -U postgres
     â”‚       â”œâ”€â–º Success: Healthy âœ“
     â”‚       â””â”€â–º Fail (5 retries): Unhealthy âœ—
     â”‚
     â”œâ”€â–º Redis Health Check
     â”‚   â””â”€â–º redis-cli ping
     â”‚       â”œâ”€â–º Success: Healthy âœ“
     â”‚       â””â”€â–º Fail (5 retries): Unhealthy âœ—
     â”‚
     â””â”€â–º App Health Check
         â””â”€â–º wget http://localhost:3001/
             â”œâ”€â–º Success: Healthy âœ“
             â””â”€â–º Fail (3 retries): Unhealthy âœ—
                 â””â”€â–º Container restart
```

## ğŸ”„ Data Persistence Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Data Persistence Strategy                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Container Lifecycle:
â”œâ”€â–º Container Created
â”‚   â””â”€â–º Mount volume to /var/lib/postgresql/data
â”‚
â”œâ”€â–º Container Running
â”‚   â”œâ”€â–º Write data to mounted volume
â”‚   â””â”€â–º Data persists on host disk
â”‚
â”œâ”€â–º Container Stopped
â”‚   â””â”€â–º Volume data remains intact
â”‚
â”œâ”€â–º Container Removed
â”‚   â””â”€â–º Volume data still exists
â”‚
â””â”€â–º docker-compose down -v
    â””â”€â–º Volumes deleted (data lost)

Backup Strategy:
â”œâ”€â–º Automated daily backups
â”œâ”€â–º Export to .sql files
â”œâ”€â–º Store in external storage (S3/GCS)
â””â”€â–º Test restore procedure monthly
```

## ğŸš€ CI/CD Integration Example

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                CI/CD Pipeline                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Git Push to main branch
         â”‚
         â–¼
2. CI Server (GitHub Actions/GitLab CI)
         â”‚
         â”œâ”€â–º Run Tests
         â”‚   â”œâ”€â–º Unit tests
         â”‚   â”œâ”€â–º Integration tests
         â”‚   â””â”€â–º E2E tests
         â”‚
         â”œâ”€â–º Build Docker Image
         â”‚   â””â”€â–º docker build -t app:latest .
         â”‚
         â”œâ”€â–º Push to Registry
         â”‚   â””â”€â–º docker push registry/app:latest
         â”‚
         â””â”€â–º Deploy to Production
             â”œâ”€â–º SSH to server
             â”œâ”€â–º docker-compose pull
             â”œâ”€â–º docker-compose up -d
             â””â”€â–º Health check validation
```

## ğŸ“ Notes

- **Scalability**: ThÃªm replicas báº±ng cÃ¡ch scale containers
- **Monitoring**: TÃ­ch há»£p Prometheus + Grafana
- **Logging**: TÃ­ch há»£p ELK Stack hoáº·c Loki
- **Backup**: Tá»± Ä‘á»™ng backup database hÃ ng ngÃ y
- **Security**: Scan images vá»›i Trivy/Snyk

---

**Document Version**: 1.0  
**Last Updated**: 2025-11-25  
**Architecture**: Microservices-ready, Container-first
